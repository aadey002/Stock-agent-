- name: Run health monitor
      env:
        TIINGO_TOKEN: ${{ secrets.TIINGO_TOKEN }}
      run: |
        python monitoring/health_monitor.py
- name: Send health notification
      if: always()
      env:
        DISCORD_ENABLED: ${{ secrets.DISCORD_ENABLED }}
        DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        SLACK_ENABLED: ${{ secrets.SLACK_ENABLED }}
        SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
      run: |
        python -c "
        import sys
        sys.path.append('notifications')
        from notifier import Notifier
        import json
        
        notifier = Notifier()
        
        # Load health data
        try:
            with open('monitoring/health_report.json') as f:
                health_data = json.load(f)
            notifier.send_health_alert(health_data)
        except:
            notifier.send_alert('Health Check', 'Health check completed', 'INFO')
        "
      continue-on-error: true