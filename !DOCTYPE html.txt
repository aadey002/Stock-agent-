<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Q5D Stock Agent - Complete Trading System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f7f9fc;
      --card: #ffffff;
      --border: #e2e8f0;
      --text: #1e293b;
      --muted: #64748b;
      --primary: #3b82f6;
      --success: #10b981;
      --danger: #ef4444;
      --warning: #f59e0b;
      --purple: #8b5cf6;
      --cyan: #06b6d4;
      --shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); }
    
    /* Header */
    .header { background: var(--card); border-bottom: 1px solid var(--border); padding: 12px 20px; position: sticky; top: 0; z-index: 100; }
    .header-inner { max-width: 1600px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; }
    .logo { display: flex; align-items: center; gap: 10px; }
    .logo-box { width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary), var(--purple)); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; }
    .logo h1 { font-size: 18px; }
    .logo p { font-size: 11px; color: var(--muted); }
    
    /* Symbol Selector */
    .symbol-select { display: flex; align-items: center; gap: 8px; }
    .symbol-select label { font-size: 12px; color: var(--muted); }
    .symbol-select select { padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 13px; background: var(--bg); cursor: pointer; }
    
    /* Tabs */
    .tabs { display: flex; gap: 4px; background: #eef2f7; padding: 4px; border-radius: 10px; }
    .tab-btn { padding: 10px 18px; border: none; background: transparent; border-radius: 8px; cursor: pointer; font-size: 13px; color: var(--muted); font-weight: 500; transition: all 0.2s; }
    .tab-btn:hover { background: #e2e8f0; }
    .tab-btn.active { background: var(--primary); color: white; }
    
    .live { display: flex; align-items: center; gap: 6px; background: #dcfce7; color: var(--success); padding: 8px 14px; border-radius: 20px; font-size: 12px; font-weight: 600; }
    .live-dot { width: 8px; height: 8px; background: var(--success); border-radius: 50%; animation: pulse 1.5s infinite; }
    @keyframes pulse { 50% { opacity: 0.4; } }
    
    /* Content */
    .content { max-width: 1600px; margin: 20px auto; padding: 0 20px; }
    .tab-panel { display: none; }
    .tab-panel.active { display: block; }
    
    /* Cards */
    .card { background: var(--card); border-radius: 16px; box-shadow: var(--shadow); padding: 20px; margin-bottom: 20px; }
    .card h3 { font-size: 14px; color: var(--muted); margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; }
    .card h3 .tag { font-size: 10px; background: #e0e7ff; color: #4338ca; padding: 4px 10px; border-radius: 12px; }
    
    /* Grid */
    .grid { display: grid; gap: 16px; }
    .g2 { grid-template-columns: repeat(2, 1fr); }
    .g3 { grid-template-columns: repeat(3, 1fr); }
    .g4 { grid-template-columns: repeat(4, 1fr); }
    .g5 { grid-template-columns: repeat(5, 1fr); }
    @media (max-width: 1200px) { .g4, .g5 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 800px) { .g2, .g3, .g4, .g5 { grid-template-columns: 1fr; } }
    
    /* Agent Cards - Clickable */
    .agent-card { background: #f8fafc; border: 2px solid var(--border); border-radius: 16px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; position: relative; }
    .agent-card:hover { border-color: var(--primary); transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59,130,246,0.15); }
    .agent-card.expanded { border-color: var(--primary); }
    .agent-card.bull { border-top: 4px solid var(--success); }
    .agent-card.bear { border-top: 4px solid var(--danger); }
    .agent-card.hold { border-top: 4px solid var(--warning); }
    .agent-card .icon { font-size: 2.5em; margin-bottom: 8px; }
    .agent-card .name { font-weight: 600; font-size: 14px; }
    .agent-card .type { font-size: 11px; color: var(--muted); margin-bottom: 12px; }
    .agent-card .direction { font-size: 2.5em; margin: 8px 0; }
    .agent-card .signal { display: inline-block; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; }
    .agent-card .signal.call { background: #dcfce7; color: var(--success); }
    .agent-card .signal.put { background: #fee2e2; color: var(--danger); }
    .agent-card .signal.hold { background: #fef3c7; color: var(--warning); }
    .agent-card .conf { margin-top: 12px; font-size: 12px; color: var(--muted); }
    .conf-bar { height: 6px; background: #e2e8f0; border-radius: 3px; margin-top: 6px; overflow: hidden; }
    .conf-fill { height: 100%; border-radius: 3px; }
    .conf-fill.high { background: var(--success); }
    .conf-fill.med { background: var(--warning); }
    .conf-fill.low { background: var(--danger); }
    
    /* Agent Details Panel */
    .agent-details { display: none; background: #f0f9ff; border: 1px solid var(--primary); border-radius: 12px; padding: 16px; margin-top: 12px; text-align: left; }
    .agent-details.show { display: block; }
    .agent-details h4 { font-size: 13px; margin-bottom: 12px; color: var(--primary); }
    .detail-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e0e7ff; font-size: 12px; }
    .detail-row:last-child { border: none; }
    .detail-label { color: var(--muted); }
    .detail-value { font-weight: 600; }
    
    /* Confluence Badge */
    .confluence-badge { position: absolute; top: 10px; right: 10px; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600; }
    .confluence-badge.ultra { background: #fef3c7; color: #d97706; }
    .confluence-badge.super { background: #dbeafe; color: #2563eb; }
    
    /* Metrics */
    .metric { background: #f8fafc; border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
    .metric .label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; }
    .metric .value { font-size: 28px; font-weight: 700; margin-top: 4px; }
    .metric .sub { font-size: 11px; color: var(--muted); margin-top: 4px; }
    
    /* Tables */
    .table-wrap { overflow-x: auto; border: 1px solid var(--border); border-radius: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 12px; }
    thead { background: #f1f5f9; }
    th, td { padding: 12px 14px; text-align: left; border-bottom: 1px solid var(--border); }
    th { font-weight: 600; color: var(--muted); font-size: 11px; text-transform: uppercase; }
    tbody tr:hover { background: #f8fafc; }
    .badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; }
    .badge.call { background: #dcfce7; color: #166534; }
    .badge.put { background: #fee2e2; color: #b91c1c; }
    .badge.ultra { background: #fef3c7; color: #d97706; }
    .badge.super { background: #dbeafe; color: #2563eb; }
    
    /* Trade Entry Form */
    .trade-form { background: #f8fafc; border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
    .form-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 12px; }
    .form-group { display: flex; flex-direction: column; gap: 4px; }
    .form-group label { font-size: 11px; color: var(--muted); text-transform: uppercase; }
    .form-group input, .form-group select { padding: 10px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 13px; }
    .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--primary); }
    .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: #2563eb; }
    .btn-success { background: var(--success); color: white; }
    .btn-danger { background: var(--danger); color: white; }
    
    /* ETF Holdings */
    .etf-selector { display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap; }
    .etf-btn { padding: 8px 16px; border: 1px solid var(--border); background: white; border-radius: 8px; cursor: pointer; font-size: 12px; transition: all 0.2s; }
    .etf-btn:hover { border-color: var(--primary); }
    .etf-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
    
    .holdings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .holdings-section h4 { font-size: 13px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .holdings-section h4 .dot { width: 10px; height: 10px; border-radius: 50%; }
    .holdings-section h4 .dot.green { background: var(--success); }
    .holdings-section h4 .dot.red { background: var(--danger); }
    
    .holding-row { display: flex; align-items: center; gap: 12px; padding: 10px; background: #f8fafc; border-radius: 8px; margin-bottom: 8px; }
    .holding-row .ticker { font-weight: 600; width: 50px; }
    .holding-row .name { flex: 1; font-size: 12px; color: var(--muted); }
    .holding-row .change { font-weight: 600; font-size: 13px; }
    .holding-row .change.pos { color: var(--success); }
    .holding-row .change.neg { color: var(--danger); }
    
    /* Sector bars */
    .sector-row { display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border); gap: 12px; cursor: pointer; transition: background 0.2s; }
    .sector-row:hover { background: #f8fafc; }
    .sector-row .name { width: 120px; font-size: 13px; font-weight: 500; }
    .sector-row .bar { flex: 1; height: 24px; background: #e2e8f0; border-radius: 6px; overflow: hidden; }
    .sector-row .fill { height: 100%; }
    .sector-row .fill.pos { background: linear-gradient(90deg, #34d399, #10b981); }
    .sector-row .fill.neg { background: linear-gradient(90deg, #f87171, #ef4444); }
    .sector-row .val { width: 70px; text-align: right; font-weight: 600; font-size: 13px; }
    
    /* Modal */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
    .modal-overlay.show { display: flex; }
    .modal { background: white; border-radius: 16px; padding: 24px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }
    .modal h2 { font-size: 18px; margin-bottom: 16px; }
    .modal-close { position: absolute; top: 16px; right: 16px; background: none; border: none; font-size: 24px; cursor: pointer; color: var(--muted); }
    
    /* Charts */
    .chart-box { background: #f8fafc; border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
    canvas { max-height: 300px; }
    
    /* Footer */
    .footer { text-align: center; padding: 24px; color: var(--muted); font-size: 12px; border-top: 1px solid var(--border); margin-top: 40px; }
    .footer a { color: var(--primary); }
  </style>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <div class="header-inner">
    <div class="logo">
      <div class="logo-box">Q5D</div>
      <div>
        <h1>Q5D Stock Agent</h1>
        <p>Quantum Multi-Agent Trading System</p>
      </div>
    </div>
    
    <!-- Symbol Selector -->
    <div class="symbol-select">
      <label>Symbol:</label>
      <select id="symbolSelect" onchange="changeSymbol()">
        <option value="SPY" selected>SPY - S&P 500</option>
        <option value="QQQ">QQQ - Nasdaq 100</option>
        <option value="IWM">IWM - Russell 2000</option>
        <option value="DIA">DIA - Dow Jones</option>
        <option value="XLK">XLK - Technology</option>
        <option value="XLF">XLF - Financials</option>
        <option value="XLE">XLE - Energy</option>
        <option value="XLV">XLV - Healthcare</option>
      </select>
    </div>
    
    <div class="tabs">
      <button class="tab-btn active" onclick="showTab('dashboard')">Dashboard</button>
      <button class="tab-btn" onclick="showTab('signals')">All Signals</button>
      <button class="tab-btn" onclick="showTab('history')">3-Year History</button>
      <button class="tab-btn" onclick="showTab('trades')">Trade Log</button>
      <button class="tab-btn" onclick="showTab('sectors')">Sectors</button>
      <button class="tab-btn" onclick="showTab('system')">System</button>
    </div>
    
    <div class="live">
      <div class="live-dot"></div>
      LIVE - Tiingo
    </div>
  </div>
</header>

<!-- CONTENT -->
<main class="content">

  <!-- TAB: DASHBOARD -->
  <div id="dashboard" class="tab-panel active">
    
    <!-- Confluence Summary -->
    <div class="card" style="background: linear-gradient(135deg, #f0f9ff, #eff6ff); border: 2px solid var(--primary);">
      <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
        <div>
          <h3 style="margin: 0; font-size: 16px; color: var(--primary);">Q5D CONSENSUS</h3>
          <div style="font-size: 3em; margin: 8px 0;">üìà</div>
          <div style="font-size: 2em; font-weight: 700; color: var(--success);" id="consensusDirection">BULLISH</div>
          <p style="color: var(--muted); margin-top: 4px;" id="consensusDesc">3 out of 4 agents agree</p>
        </div>
        <div style="display: flex; gap: 30px; text-align: center;">
          <div>
            <div style="font-size: 2.5em; font-weight: 700; color: var(--success);" id="bullVotes">3</div>
            <div style="font-size: 12px; color: var(--muted);">Bullish</div>
          </div>
          <div>
            <div style="font-size: 2.5em; font-weight: 700; color: var(--danger);" id="bearVotes">0</div>
            <div style="font-size: 12px; color: var(--muted);">Bearish</div>
          </div>
          <div>
            <div style="font-size: 2.5em; font-weight: 700; color: var(--warning);" id="holdVotes">1</div>
            <div style="font-size: 12px; color: var(--muted);">Neutral</div>
          </div>
        </div>
        <div style="text-align: center; background: white; padding: 16px 24px; border-radius: 12px;">
          <div style="font-size: 11px; color: var(--muted); text-transform: uppercase;">Confluence Level</div>
          <div style="font-size: 1.5em; font-weight: 700; color: #d97706; margin-top: 4px;" id="confluenceLevel">‚≠ê SUPER (3/4)</div>
        </div>
      </div>
    </div>
    
    <!-- 4 Agent Cards - Clickable -->
    <div class="grid g4" id="agentCards">
      <!-- Agent 1: Confluence -->
      <div class="agent-card bull" onclick="toggleAgentDetails(0)">
        <span class="confluence-badge super">3/4</span>
        <div class="icon">üìä</div>
        <div class="name">System A: Confluence</div>
        <div class="type">SMA Crossover + Technical</div>
        <div class="direction">‚¨ÜÔ∏è</div>
        <div class="signal call">CALL</div>
        <div class="conf">Confidence: 78%
          <div class="conf-bar"><div class="conf-fill high" style="width:78%"></div></div>
        </div>
        <div class="agent-details" id="agentDetail0">
          <h4>üìä Confluence Details</h4>
          <div class="detail-row"><span class="detail-label">Fast SMA</span><span class="detail-value">$672.45</span></div>
          <div class="detail-row"><span class="detail-label">Slow SMA</span><span class="detail-value">$668.12</span></div>
          <div class="detail-row"><span class="detail-label">Bias</span><span class="detail-value" style="color:var(--success)">BULLISH</span></div>
          <div class="detail-row"><span class="detail-label">Price Confluence</span><span class="detail-value">2</span></div>
          <div class="detail-row"><span class="detail-label">Time Confluence</span><span class="detail-value">1</span></div>
          <div class="detail-row"><span class="detail-label">Entry</span><span class="detail-value">$671.93</span></div>
          <div class="detail-row"><span class="detail-label">Stop Loss</span><span class="detail-value" style="color:var(--danger)">$654.96</span></div>
          <div class="detail-row"><span class="detail-label">Target 1</span><span class="detail-value" style="color:var(--success)">$695.42</span></div>
        </div>
      </div>
      
      <!-- Agent 2: Gann-Elliott -->
      <div class="agent-card bull" onclick="toggleAgentDetails(1)">
        <span class="confluence-badge super">3/4</span>
        <div class="icon">üîÆ</div>
        <div class="name">System B: Gann-Elliott</div>
        <div class="type">Wave + Fibonacci + Gann</div>
        <div class="direction">‚¨ÜÔ∏è</div>
        <div class="signal call">CALL</div>
        <div class="conf">Confidence: 75%
          <div class="conf-bar"><div class="conf-fill high" style="width:75%"></div></div>
        </div>
        <div class="agent-details" id="agentDetail1">
          <h4>üîÆ Gann-Elliott Details</h4>
          <div class="detail-row"><span class="detail-label">Elliott Wave</span><span class="detail-value">Wave 3</span></div>
          <div class="detail-row"><span class="detail-label">Trend</span><span class="detail-value" style="color:var(--success)">UP</span></div>
          <div class="detail-row"><span class="detail-label">Fib 0.382</span><span class="detail-value">$658.24</span></div>
          <div class="detail-row"><span class="detail-label">Fib 0.618</span><span class="detail-value">$682.15</span></div>
          <div class="detail-row"><span class="detail-label">Gann Level</span><span class="detail-value">$675.00</span></div>
          <div class="detail-row"><span class="detail-label">Range Position</span><span class="detail-value">45%</span></div>
          <div class="detail-row"><span class="detail-label">Entry</span><span class="detail-value">$671.93</span></div>
          <div class="detail-row"><span class="detail-label">Stop Loss</span><span class="detail-value" style="color:var(--danger)">$652.18</span></div>
        </div>
      </div>
      
      <!-- Agent 3: DQN -->
      <div class="agent-card bull" onclick="toggleAgentDetails(2)">
        <span class="confluence-badge super">3/4</span>
        <div class="icon">üß†</div>
        <div class="name">DQN Agent</div>
        <div class="type">Deep Q-Network RL</div>
        <div class="direction">‚¨ÜÔ∏è</div>
        <div class="signal call">CALL</div>
        <div class="conf">Confidence: 65%
          <div class="conf-bar"><div class="conf-fill med" style="width:65%"></div></div>
        </div>
        <div class="agent-details" id="agentDetail2">
          <h4>üß† DQN/RL Details</h4>
          <div class="detail-row"><span class="detail-label">RSI (14)</span><span class="detail-value">58.3</span></div>
          <div class="detail-row"><span class="detail-label">Momentum</span><span class="detail-value" style="color:var(--success)">+0.42%</span></div>
          <div class="detail-row"><span class="detail-label">Q-Value (CALL)</span><span class="detail-value">0.72</span></div>
          <div class="detail-row"><span class="detail-label">Q-Value (PUT)</span><span class="detail-value">0.18</span></div>
          <div class="detail-row"><span class="detail-label">Q-Value (HOLD)</span><span class="detail-value">0.10</span></div>
          <div class="detail-row"><span class="detail-label">Epsilon</span><span class="detail-value">0.05</span></div>
          <div class="detail-row"><span class="detail-label">State Features</span><span class="detail-value">20</span></div>
          <div class="detail-row"><span class="detail-label">Training Episodes</span><span class="detail-value">1,000</span></div>
        </div>
      </div>
      
      <!-- Agent 4: 3-Wave -->
      <div class="agent-card hold" onclick="toggleAgentDetails(3)">
        <div class="icon">üåä</div>
        <div class="name">3-Wave System</div>
        <div class="type">Momentum + Profit Targets</div>
        <div class="direction">‚û°Ô∏è</div>
        <div class="signal hold">HOLD</div>
        <div class="conf">Confidence: 45%
          <div class="conf-bar"><div class="conf-fill low" style="width:45%"></div></div>
        </div>
        <div class="agent-details" id="agentDetail3">
          <h4>üåä 3-Wave Details</h4>
          <div class="detail-row"><span class="detail-label">5-Day Momentum</span><span class="detail-value">+0.12%</span></div>
          <div class="detail-row"><span class="detail-label">10-Day Momentum</span><span class="detail-value">-0.28%</span></div>
          <div class="detail-row"><span class="detail-label">20-Day Momentum</span><span class="detail-value">+1.45%</span></div>
          <div class="detail-row"><span class="detail-label">Alignment</span><span class="detail-value" style="color:var(--warning)">MIXED</span></div>
          <div class="detail-row"><span class="detail-label">Volatility Ratio</span><span class="detail-value">1.12</span></div>
          <div class="detail-row"><span class="detail-label">Wave 1 Target</span><span class="detail-value">1.5R</span></div>
          <div class="detail-row"><span class="detail-label">Wave 2 Target</span><span class="detail-value">2.5R</span></div>
          <div class="detail-row"><span class="detail-label">Wave 3 Target</span><span class="detail-value">4.0R</span></div>
        </div>
      </div>
    </div>
    
    <!-- Metrics -->
    <div class="grid g5">
      <div class="metric">
        <div class="label">Total Signals</div>
        <div class="value" style="color: var(--primary);" id="totalSignals">330</div>
        <div class="sub">3-year backtest</div>
      </div>
      <div class="metric">
        <div class="label">ULTRA (4/4)</div>
        <div class="value" style="color: #d97706;" id="ultraCount">12</div>
        <div class="sub">Highest conviction</div>
      </div>
      <div class="metric">
        <div class="label">SUPER (3/4)</div>
        <div class="value" style="color: var(--primary);" id="superCount">45</div>
        <div class="sub">High conviction</div>
      </div>
      <div class="metric">
        <div class="label">Win Rate</div>
        <div class="value" style="color: var(--success);" id="winRate">67%</div>
        <div class="sub">Historical accuracy</div>
      </div>
      <div class="metric">
        <div class="label">Paper P&L</div>
        <div class="value" style="color: var(--success);" id="paperPnL">+$1,250</div>
        <div class="sub">+12.5% return</div>
      </div>
    </div>
    
    <!-- Latest Signal -->
    <div class="card">
      <h3>Latest Signal - 3 Wave Targets <span class="tag" id="latestDate">2025-11-14</span></h3>
      <div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 16px; border-bottom: 1px solid var(--border); margin-bottom: 16px; flex-wrap: wrap; gap: 16px;">
        <div style="display: flex; align-items: center; gap: 16px;">
          <span class="badge call" style="font-size: 18px; padding: 12px 28px;" id="latestSignal">CALL</span>
          <span class="badge super" id="latestConfluence">‚≠ê SUPER 3/4</span>
        </div>
        <div style="text-align: right;">
          <div style="font-size: 11px; color: var(--muted);">Entry Price</div>
          <div style="font-size: 2.5em; font-weight: 700; color: var(--primary);" id="latestEntry">$671.93</div>
        </div>
      </div>
      <div class="grid g4">
        <div style="background: #fef2f2; border-left: 4px solid var(--danger); border-radius: 8px; padding: 16px; text-align: center;">
          <div style="font-size: 10px; color: var(--muted); text-transform: uppercase;">Stop Loss</div>
          <div style="font-size: 1.4em; font-weight: 700;" id="latestStop">$654.96</div>
          <div style="font-size: 12px; color: var(--danger); font-weight: 600;">-2.5%</div>
        </div>
        <div style="background: #f0fdf4; border-left: 4px solid var(--success); border-radius: 8px; padding: 16px; text-align: center;">
          <div style="font-size: 10px; color: var(--muted); text-transform: uppercase;">Wave 1 (33%)</div>
          <div style="font-size: 1.4em; font-weight: 700;" id="latestT1">$695.42</div>
          <div style="font-size: 12px; color: var(--success); font-weight: 600;">+3.5%</div>
        </div>
        <div style="background: #eff6ff; border-left: 4px solid var(--primary); border-radius: 8px; padding: 16px; text-align: center;">
          <div style="font-size: 10px; color: var(--muted); text-transform: uppercase;">Wave 2 (33%)</div>
          <div style="font-size: 1.4em; font-weight: 700;" id="latestT2">$711.08</div>
          <div style="font-size: 12px; color: var(--primary); font-weight: 600;">+5.8%</div>
        </div>
        <div style="background: #f5f3ff; border-left: 4px solid var(--purple); border-radius: 8px; padding: 16px; text-align: center;">
          <div style="font-size: 10px; color: var(--muted); text-transform: uppercase;">Wave 3 (34%)</div>
          <div style="font-size: 1.4em; font-weight: 700;" id="latestT3">$734.57</div>
          <div style="font-size: 12px; color: var(--purple); font-weight: 600;">+9.3%</div>
        </div>
      </div>
    </div>
    
    <!-- Charts -->
    <div class="grid g2">
      <div class="card">
        <h3>Signal Distribution</h3>
        <div class="chart-box"><canvas id="signalChart"></canvas></div>
      </div>
      <div class="card">
        <h3>Confluence Distribution</h3>
        <div class="chart-box"><canvas id="confluenceChart"></canvas></div>
      </div>
    </div>
  </div>

  <!-- TAB: ALL SIGNALS -->
  <div id="signals" class="tab-panel">
    <div class="card">
      <h3>All Signals - Agent Breakdown <span class="tag">Which agent triggered what</span></h3>
      <div style="margin-bottom: 16px; display: flex; gap: 12px; flex-wrap: wrap;">
        <select id="filterConfluence" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
          <option value="all">All Confluence Levels</option>
          <option value="ultra">üî• ULTRA (4/4)</option>
          <option value="super">‚≠ê SUPER (3/4)</option>
          <option value="partial">üìä PARTIAL (2/4)</option>
        </select>
        <select id="filterSignal" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
          <option value="all">All Signals</option>
          <option value="call">CALL Only</option>
          <option value="put">PUT Only</option>
        </select>
        <input type="date" id="filterStartDate" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
        <input type="date" id="filterEndDate" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px;">
        <button class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
      </div>
      <div class="table-wrap">
        <table id="signalsTable">
          <thead>
            <tr>
              <th>Date</th>
              <th>Confluence</th>
              <th>üìä A1</th>
              <th>üîÆ A2</th>
              <th>üß† A3</th>
              <th>üåä A4</th>
              <th>Votes</th>
              <th>Final</th>
              <th>Entry</th>
              <th>Stop</th>
              <th>T1</th>
            </tr>
          </thead>
          <tbody id="signalsTableBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- TAB: 3-YEAR HISTORY -->
  <div id="history" class="tab-panel">
    <div class="card">
      <h3>3-Year Historical Signals <span class="tag">Full Backtest Reference</span></h3>
      <div class="grid g4" style="margin-bottom: 20px;">
        <div class="metric">
          <div class="label">Total Bars</div>
          <div class="value">756</div>
          <div class="sub">~3 years of data</div>
        </div>
        <div class="metric">
          <div class="label">ULTRA Signals</div>
          <div class="value" style="color: #d97706;">12</div>
          <div class="sub">4/4 agreement</div>
        </div>
        <div class="metric">
          <div class="label">SUPER Signals</div>
          <div class="value" style="color: var(--primary);">45</div>
          <div class="sub">3/4 agreement</div>
        </div>
        <div class="metric">
          <div class="label">PARTIAL Signals</div>
          <div class="value" style="color: var(--muted);">128</div>
          <div class="sub">2/4 agreement</div>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Level</th>
              <th>Signal</th>
              <th>Votes</th>
              <th>Entry</th>
              <th>Stop</th>
              <th>T1</th>
              <th>T2</th>
              <th>T3</th>
              <th>Outcome</th>
            </tr>
          </thead>
          <tbody id="historyTableBody">
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="card">
      <h3>Historical Performance Chart</h3>
      <div class="chart-box"><canvas id="historyChart"></canvas></div>
    </div>
  </div>

  <!-- TAB: TRADE LOG -->
  <div id="trades" class="tab-panel">
    <div class="card">
      <h3>Log New Trade <span class="tag">Paper & Real Trading</span></h3>
      <div class="trade-form">
        <div class="form-row">
          <div class="form-group">
            <label>Trade Type</label>
            <select id="tradeType">
              <option value="paper">Paper Trade</option>
              <option value="real">Real Trade</option>
            </select>
          </div>
          <div class="form-group">
            <label>Symbol</label>
            <select id="tradeSymbol">
              <option value="SPY">SPY</option>
              <option value="QQQ">QQQ</option>
              <option value="IWM">IWM</option>
            </select>
          </div>
          <div class="form-group">
            <label>Direction</label>
            <select id="tradeDirection">
              <option value="CALL">CALL</option>
              <option value="PUT">PUT</option>
            </select>
          </div>
          <div class="form-group">
            <label>Confluence Level</label>
            <select id="tradeConfluence">
              <option value="ultra">üî• ULTRA (4/4)</option>
              <option value="super">‚≠ê SUPER (3/4)</option>
              <option value="partial">üìä PARTIAL (2/4)</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Entry Price</label>
            <input type="number" id="tradeEntry" placeholder="671.93" step="0.01">
          </div>
          <div class="form-group">
            <label>Stop Loss</label>
            <input type="number" id="tradeStop" placeholder="654.96" step="0.01">
          </div>
          <div class="form-group">
            <label>Target 1</label>
            <input type="number" id="tradeT1" placeholder="695.42" step="0.01">
          </div>
          <div class="form-group">
            <label>Shares/Contracts</label>
            <input type="number" id="tradeShares" placeholder="10">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Entry Date</label>
            <input type="date" id="tradeEntryDate">
          </div>
          <div class="form-group">
            <label>Notes</label>
            <input type="text" id="tradeNotes" placeholder="Optional notes...">
          </div>
          <div class="form-group" style="justify-content: flex-end;">
            <button class="btn btn-success" onclick="logTrade()">Log Trade</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <h3>Trade History <span class="tag">Performance Tracking</span></h3>
      <div class="grid g4" style="margin-bottom: 20px;">
        <div class="metric">
          <div class="label">Total Trades</div>
          <div class="value" id="totalTrades">5</div>
        </div>
        <div class="metric">
          <div class="label">Win Rate</div>
          <div class="value" style="color: var(--success);" id="tradeWinRate">80%</div>
        </div>
        <div class="metric">
          <div class="label">Total P&L</div>
          <div class="value" style="color: var(--success);" id="totalPnL">+$1,475</div>
        </div>
        <div class="metric">
          <div class="label">Avg R:R</div>
          <div class="value" id="avgRR">2.3</div>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Type</th>
              <th>Symbol</th>
              <th>Direction</th>
              <th>Confluence</th>
              <th>Entry</th>
              <th>Exit</th>
              <th>Status</th>
              <th>P&L</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="tradeLogBody">
            <tr>
              <td>2025-11-14</td>
              <td>Paper</td>
              <td>SPY</td>
              <td><span class="badge call">CALL</span></td>
              <td><span class="badge super">SUPER</span></td>
              <td>$671.93</td>
              <td>--</td>
              <td style="color: var(--primary);">OPEN</td>
              <td>--</td>
              <td><button class="btn btn-primary" style="padding: 4px 12px; font-size: 11px;" onclick="closeTrade(0)">Close</button></td>
            </tr>
            <tr>
              <td>2025-11-11</td>
              <td>Paper</td>
              <td>SPY</td>
              <td><span class="badge call">CALL</span></td>
              <td><span class="badge ultra">ULTRA</span></td>
              <td>$683.00</td>
              <td>$704.51</td>
              <td style="color: var(--success);">T1 HIT</td>
              <td style="color: var(--success);">+$215</td>
              <td>--</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- TAB: SECTORS -->
  <div id="sectors" class="tab-panel">
    <div class="card">
      <h3>Sector Performance <span class="tag">Click to see holdings</span></h3>
      <div id="sectorList">
        <div class="sector-row" onclick="showSectorHoldings('XLV')">
          <span class="name">XLV Healthcare</span>
          <div class="bar"><div class="fill pos" style="width:60%"></div></div>
          <span class="val" style="color: var(--success);">+1.83%</span>
        </div>
        <div class="sector-row" onclick="showSectorHoldings('XLP')">
          <span class="name">XLP Staples</span>
          <div class="bar"><div class="fill pos" style="width:45%"></div></div>
          <span class="val" style="color: var(--success);">+0.66%</span>
        </div>
        <div class="sector-row" onclick="showSectorHoldings('XLU')">
          <span class="name">XLU Utilities</span>
          <div class="bar"><div class="fill pos" style="width:35%"></div></div>
          <span class="val" style="color: var(--success);">+0.42%</span>
        </div>
        <div class="sector-row" onclick="showSectorHoldings('XLF')">
          <span class="name">XLF Financials</span>
          <div class="bar"><div class="fill neg" style="width:30%"></div></div>
          <span class="val" style="color: var(--danger);">-1.25%</span>
        </div>
        <div class="sector-row" onclick="showSectorHoldings('XLK')">
          <span class="name">XLK Tech</span>
          <div class="bar"><div class="fill neg" style="width:70%"></div></div>
          <span class="val" style="color: var(--danger);">-5.19%</span>
        </div>
      </div>
    </div>
    
    <div class="card" id="holdingsCard" style="display: none;">
      <h3>ETF Holdings: <span id="selectedETF">XLK</span> <span class="tag">Top 3 & Bottom 3</span></h3>
      <div class="holdings-grid">
        <div class="holdings-section">
          <h4><span class="dot green"></span> Top 3 Performers</h4>
          <div id="topHoldings">
            <div class="holding-row">
              <span class="ticker">AAPL</span>
              <span class="name">Apple Inc</span>
              <span class="change pos">+2.45%</span>
            </div>
            <div class="holding-row">
              <span class="ticker">NVDA</span>
              <span class="name">NVIDIA Corp</span>
              <span class="change pos">+1.89%</span>
            </div>
            <div class="holding-row">
              <span class="ticker">MSFT</span>
              <span class="name">Microsoft Corp</span>
              <span class="change pos">+1.12%</span>
            </div>
          </div>
        </div>
        <div class="holdings-section">
          <h4><span class="dot red"></span> Bottom 3 Performers</h4>
          <div id="bottomHoldings">
            <div class="holding-row">
              <span class="ticker">INTC</span>
              <span class="name">Intel Corp</span>
              <span class="change neg">-4.21%</span>
            </div>
            <div class="holding-row">
              <span class="ticker">AMD</span>
              <span class="name">AMD Inc</span>
              <span class="change neg">-3.56%</span>
            </div>
            <div class="holding-row">
              <span class="ticker">CRM</span>
              <span class="name">Salesforce</span>
              <span class="change neg">-2.18%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="grid g2">
      <div class="card">
        <h3>Market Regime</h3>
        <div class="metric" style="margin-bottom: 12px; border-left: 4px solid var(--warning);">
          <div class="label">Current Regime</div>
          <div class="value" style="color: var(--warning);">RANGING</div>
        </div>
        <div class="metric" style="margin-bottom: 12px;">
          <div class="label">Rotation</div>
          <div class="value" style="color: var(--danger);">RISK-OFF</div>
        </div>
        <div class="metric">
          <div class="label">Volatility</div>
          <div class="value">18.5%</div>
        </div>
      </div>
      <div class="card">
        <h3>Sector Rotation Trend</h3>
        <div class="chart-box"><canvas id="rotationChart"></canvas></div>
      </div>
    </div>
  </div>

  <!-- TAB: SYSTEM -->
  <div id="system" class="tab-panel">
    <div class="grid g2">
      <div class="card">
        <h3>Trading Agents</h3>
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üìä</span>
            <div style="flex: 1;"><div style="font-weight: 600;">System A: Confluence</div><div style="font-size: 11px; color: var(--muted);">SMA Crossover + Technical</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üîÆ</span>
            <div style="flex: 1;"><div style="font-weight: 600;">System B: Gann-Elliott</div><div style="font-size: 11px; color: var(--muted);">Wave + Fibonacci + Gann</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üß†</span>
            <div style="flex: 1;"><div style="font-weight: 600;">DQN Agent</div><div style="font-size: 11px; color: var(--muted);">Deep Q-Network RL</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üåä</span>
            <div style="flex: 1;"><div style="font-weight: 600;">3-Wave System</div><div style="font-size: 11px; color: var(--muted);">Momentum + Profit Targets</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
        </div>
      </div>
      <div class="card">
        <h3>Market Guardrails</h3>
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üìà</span>
            <div style="flex: 1;"><div style="font-weight: 600;">Volatility Filter</div><div style="font-size: 11px; color: var(--muted);">VIX-based sizing</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üìÖ</span>
            <div style="flex: 1;"><div style="font-weight: 600;">Economic Calendar</div><div style="font-size: 11px; color: var(--muted);">FOMC, NFP, CPI, GDP</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üòä</span>
            <div style="flex: 1;"><div style="font-weight: 600;">Sentiment Analysis</div><div style="font-size: 11px; color: var(--muted);">Fear & Greed</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
          <div style="display: flex; align-items: center; gap: 12px; padding: 14px; background: #f8fafc; border-radius: 10px; border: 1px solid var(--border);">
            <span style="font-size: 1.5em;">üîÑ</span>
            <div style="flex: 1;"><div style="font-weight: 600;">Sector Rotation</div><div style="font-size: 11px; color: var(--muted);">Risk-On vs Risk-Off</div></div>
            <span style="background: #dcfce7; color: var(--success); padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600;">Active</span>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <h3>System Configuration</h3>
      <div class="grid g3">
        <div class="metric"><div class="label">Symbol</div><div class="value">SPY</div></div>
        <div class="metric"><div class="label">Data Source</div><div class="value">Tiingo</div></div>
        <div class="metric"><div class="label">History</div><div class="value">3 Years</div></div>
        <div class="metric"><div class="label">Broker</div><div class="value">Robinhood</div></div>
        <div class="metric"><div class="label">Risk/Trade</div><div class="value">2%</div></div>
        <div class="metric"><div class="label">Last Update</div><div class="value" id="lastUpdate">--</div></div>
      </div>
    </div>
  </div>

</main>

<footer class="footer">
  <p>Q5D Stock Agent - Quantum Multi-Agent Trading System</p>
  <p style="margin-top: 8px;"><a href="https://github.com/aadey002/Stock-agent-" target="_blank">GitHub Repository</a></p>
</footer>

<script>
// Tab switching
function showTab(name) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(name).classList.add('active');
  event.target.classList.add('active');
}

// Agent details toggle
function toggleAgentDetails(index) {
  const detail = document.getElementById('agentDetail' + index);
  detail.classList.toggle('show');
}

// Symbol selector
function changeSymbol() {
  const symbol = document.getElementById('symbolSelect').value;
  alert('Symbol changed to: ' + symbol + '\n\nNote: Multi-symbol support coming soon!');
}

// Sector holdings
function showSectorHoldings(etf) {
  document.getElementById('holdingsCard').style.display = 'block';
  document.getElementById('selectedETF').textContent = etf;
  
  const holdings = {
    'XLK': {
      top: [
        {ticker: 'AAPL', name: 'Apple Inc', change: '+2.45%'},
        {ticker: 'NVDA', name: 'NVIDIA Corp', change: '+1.89%'},
        {ticker: 'MSFT', name: 'Microsoft Corp', change: '+1.12%'}
      ],
      bottom: [
        {ticker: 'INTC', name: 'Intel Corp', change: '-4.21%'},
        {ticker: 'AMD', name: 'AMD Inc', change: '-3.56%'},
        {ticker: 'CRM', name: 'Salesforce', change: '-2.18%'}
      ]
    },
    'XLV': {
      top: [
        {ticker: 'UNH', name: 'UnitedHealth', change: '+3.12%'},
        {ticker: 'JNJ', name: 'Johnson & Johnson', change: '+1.85%'},
        {ticker: 'LLY', name: 'Eli Lilly', change: '+1.45%'}
      ],
      bottom: [
        {ticker: 'PFE', name: 'Pfizer', change: '-2.34%'},
        {ticker: 'CVS', name: 'CVS Health', change: '-1.89%'},
        {ticker: 'BMY', name: 'Bristol Myers', change: '-1.23%'}
      ]
    }
  };
  
  const data = holdings[etf] || holdings['XLK'];
  
  document.getElementById('topHoldings').innerHTML = data.top.map(h => `
    <div class="holding-row">
      <span class="ticker">${h.ticker}</span>
      <span class="name">${h.name}</span>
      <span class="change pos">${h.change}</span>
    </div>
  `).join('');
  
  document.getElementById('bottomHoldings').innerHTML = data.bottom.map(h => `
    <div class="holding-row">
      <span class="ticker">${h.ticker}</span>
      <span class="name">${h.name}</span>
      <span class="change neg">${h.change}</span>
    </div>
  `).join('');
}

// Trade logging
function logTrade() {
  const trade = {
    type: document.getElementById('tradeType').value,
    symbol: document.getElementById('tradeSymbol').value,
    direction: document.getElementById('tradeDirection').value,
    confluence: document.getElementById('tradeConfluence').value,
    entry: document.getElementById('tradeEntry').value,
    stop: document.getElementById('tradeStop').value,
    t1: document.getElementById('tradeT1').value,
    shares: document.getElementById('tradeShares').value,
    date: document.getElementById('tradeEntryDate').value,
    notes: document.getElementById('tradeNotes').value
  };
  
  // Save to localStorage
  let trades = JSON.parse(localStorage.getItem('q5d_trades') || '[]');
  trades.push(trade);
  localStorage.setItem('q5d_trades', JSON.stringify(trades));
  
  alert('Trade logged successfully!\n\n' + JSON.stringify(trade, null, 2));
  loadTrades();
}

function loadTrades() {
  // Load from localStorage and display
  let trades = JSON.parse(localStorage.getItem('q5d_trades') || '[]');
  // Update table...
}

function closeTrade(index) {
  const exitPrice = prompt('Enter exit price:');
  if (exitPrice) {
    alert('Trade closed at $' + exitPrice);
  }
}

function applyFilters() {
  alert('Filters applied! (Data loading...)');
}

// Update timestamp
document.getElementById('lastUpdate').textContent = new Date().toLocaleString();

// Charts
new Chart(document.getElementById('signalChart'), {
  type: 'doughnut',
  data: {
    labels: ['CALL (285)', 'PUT (45)'],
    datasets: [{data: [285, 45], backgroundColor: ['#10b981', '#ef4444'], borderWidth: 0}]
  },
  options: { plugins: { legend: { position: 'bottom' } } }
});

new Chart(document.getElementById('confluenceChart'), {
  type: 'bar',
  data: {
    labels: ['ULTRA 4/4', 'SUPER 3/4', 'PARTIAL 2/4', 'WEAK 1/4'],
    datasets: [{
      label: 'Count',
      data: [12, 45, 128, 245],
      backgroundColor: ['#f59e0b', '#3b82f6', '#8b5cf6', '#e2e8f0']
    }]
  },
  options: {
    plugins: { legend: { display: false } },
    scales: { y: { beginAtZero: true } }
  }
});

new Chart(document.getElementById('rotationChart'), {
  type: 'line',
  data: {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov'],
    datasets: [
      { label: 'Cyclical', data: [5.2, 3.1, -2.4, 4.5, 6.2, 2.1, -1.5, -3.2, 1.2, -1.8, -2.65], borderColor: '#3b82f6', tension: 0.4, fill: false },
      { label: 'Defensive', data: [1.2, 2.1, 3.5, 1.8, -0.5, 1.2, 2.8, 3.5, 2.1, 1.5, 0.66], borderColor: '#10b981', tension: 0.4, fill: false }
    ]
  },
  options: { scales: { y: { grid: { color: '#e2e8f0' } } } }
});

// Load historical signals
async function loadSignals() {
  try {
    const res = await fetch('reports/playbook_comparison.csv');
    if (res.ok) {
      const text = await res.text();
      const lines = text.trim().split('\n');
      const headers = lines[0].split(',');
      const rows = lines.slice(1).map(line => {
        const vals = line.split(',');
        const obj = {};
        headers.forEach((h, i) => obj[h.trim()] = vals[i]?.trim() || '');
        return obj;
      });
      
      // Populate signals table
      const tbody = document.getElementById('signalsTableBody');
      const recent = rows.filter(r => r.confluence_level && (r.confluence_level.includes('ULTRA') || r.confluence_level.includes('SUPER'))).slice(-50).reverse();
      
      tbody.innerHTML = recent.map(r => `
        <tr>
          <td>${r.date || ''}</td>
          <td><span class="badge ${r.confluence_level?.includes('ULTRA') ? 'ultra' : 'super'}">${r.confluence_level || ''}</span></td>
          <td><span class="badge ${(r.A1_Confluence || '').toLowerCase()}">${r.A1_Confluence || ''}</span></td>
          <td><span class="badge ${(r.A2_GannElliott || '').toLowerCase()}">${r.A2_GannElliott || ''}</span></td>
          <td><span class="badge ${(r.A3_DQN || '').toLowerCase()}">${r.A3_DQN || ''}</span></td>
          <td><span class="badge ${(r.A4_3Wave || '').toLowerCase()}">${r.A4_3Wave || ''}</span></td>
          <td>${r.call_votes || 0}/${r.put_votes || 0}/${r.hold_votes || 0}</td>
          <td><span class="badge ${(r.majority || '').toLowerCase()}">${r.majority || ''}</span></td>
          <td>$${parseFloat(r.entry || 0).toFixed(2)}</td>
          <td style="color: #ef4444;">$${parseFloat(r.stop || 0).toFixed(2)}</td>
          <td style="color: #10b981;">$${parseFloat(r.target1 || 0).toFixed(2)}</td>
        </tr>
      `).join('');
      
      // Update metrics
      document.getElementById('totalSignals').textContent = rows.length;
      document.getElementById('ultraCount').textContent = rows.filter(r => r.confluence_level?.includes('ULTRA')).length;
      document.getElementById('superCount').textContent = rows.filter(r => r.confluence_level?.includes('SUPER')).length;
    }
  } catch (e) {
    console.log('Could not load signals:', e);
  }
}

loadSignals();
</script>

</body>
</html>